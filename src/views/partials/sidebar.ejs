<!-- Professional Admin Sidebar -->
<div class="flex h-screen bg-gray-50">
  <!-- Sidebar -->
  <div class="hidden lg:flex lg:flex-shrink-0">
    <div class="flex flex-col w-64">
      <!-- Sidebar component -->
      <div
        class="flex flex-col flex-grow bg-gradient-to-b from-gray-800 to-gray-900 pt-5 pb-4 overflow-y-auto"
      >
        <!-- Logo & Brand -->
        <div class="flex items-center flex-shrink-0 px-4">
          <div class="flex items-center">
            <div
              class="h-8 w-8 bg-blue-600 rounded-lg flex items-center justify-center"
            >
              <i class="fas fa-shipping-fast text-white text-sm"></i>
            </div>
            <div class="ml-3">
              <h1 class="text-white text-lg font-bold">LogiTrack</h1>
              <p class="text-gray-400 text-xs">Admin Portal</p>
            </div>
          </div>
        </div>

        <!-- Navigation -->
        <nav class="mt-8 flex-1 flex flex-col px-4 space-y-2">
          <!-- Dashboard -->
          <a
            href="/admin"
            class="group flex items-center px-3 py-2 text-sm font-medium rounded-lg transition-all duration-200 <%= currentPage === 'dashboard' ? 'bg-blue-600 text-white shadow-lg' : 'text-gray-300 hover:bg-gray-700 hover:text-white' %>"
          >
            <i
              class="fas fa-tachometer-alt mr-3 text-sm w-5 text-center <%= currentPage === 'dashboard' ? 'text-white' : 'text-gray-400 group-hover:text-white' %>"
            ></i>
            Dashboard
          </a>

          <!-- Deliveries -->
          <a
            href="/admin/deliveries"
            class="group flex items-center px-3 py-2 text-sm font-medium rounded-lg transition-all duration-200 <%= currentPage === 'deliveries' || currentPage === 'delivery' ? 'bg-blue-600 text-white shadow-lg' : 'text-gray-300 hover:bg-gray-700 hover:text-white' %>"
          >
            <i
              class="fas fa-box mr-3 text-sm w-5 text-center <%= currentPage === 'deliveries' || currentPage === 'delivery' ? 'text-white' : 'text-gray-400 group-hover:text-white' %>"
            ></i>
            Deliveries
            <% if (deliveryCount) { %>
              <span
                class="ml-auto bg-blue-500 text-white text-xs font-medium px-2 py-0.5 rounded-full"
              >
                <%= deliveryCount %>
              </span>
            <% } %>
          </a>

          <!-- Drivers -->
          <a
            href="/admin/drivers"
            class="group flex items-center px-3 py-2 text-sm font-medium rounded-lg transition-all duration-200 <%= currentPage === 'drivers' || currentPage === 'driver' ? 'bg-blue-600 text-white shadow-lg' : 'text-gray-300 hover:bg-gray-700 hover:text-white' %>"
          >
            <i
              class="fas fa-users mr-3 text-sm w-5 text-center <%= currentPage === 'drivers' || currentPage === 'driver' ? 'text-white' : 'text-gray-400 group-hover:text-white' %>"
            ></i>
            Drivers
            <% if (driverCount) { %>
              <span
                class="ml-auto bg-green-500 text-white text-xs font-medium px-2 py-0.5 rounded-full"
              >
                <%= driverCount %>
              </span>
            <% } %>
          </a>

          <!-- Warehouses -->
          <a
            href="/admin/warehouses"
            class="group flex items-center px-3 py-2 text-sm font-medium rounded-lg transition-all duration-200 <%= currentPage === 'warehouses' || currentPage === 'warehouse' ? 'bg-blue-600 text-white shadow-lg' : 'text-gray-300 hover:bg-gray-700 hover:text-white' %>"
          >
            <i
              class="fas fa-warehouse mr-3 text-sm w-5 text-center <%= currentPage === 'warehouses' || currentPage === 'warehouse' ? 'text-white' : 'text-gray-400 group-hover:text-white' %>"
            ></i>
            Warehouses
          </a>

          <!-- Settings -->
          <a
            href="/admin/settings"
            class="group flex items-center px-3 py-2 text-sm font-medium rounded-lg transition-all duration-200 <%= currentPage === 'settings' ? 'bg-blue-600 text-white shadow-lg' : 'text-gray-300 hover:bg-gray-700 hover:text-white' %>"
          >
            <i
              class="fas fa-cog mr-3 text-sm w-5 text-center <%= currentPage === 'settings' ? 'text-white' : 'text-gray-400 group-hover:text-white' %>"
            ></i>
            Settings
          </a>
        </nav>

        <!-- User Profile -->
        <div class="flex-shrink-0 flex border-t border-gray-700 p-4">
          <div class="flex items-center w-full">
            <div class="flex-shrink-0">
              <div class="h-10 w-10 rounded-full bg-blue-500 flex items-center justify-center">
                <span class="text-white font-semibold">
                  <%= admin && admin.name ? admin.name.charAt(0).toUpperCase() : 'A' %>
                </span>
              </div>
            </div>
            <div class="ml-3 flex-1">
              <p class="text-sm font-medium text-white">
                <%= admin && admin.name ? admin.name : 'Admin User' %>
              </p>
              <p
                class="text-xs font-medium text-gray-400 group-hover:text-gray-300"
              >
                <%= admin && admin.role ? admin.role : 'Administrator' %>
              </p>
            </div>
            <div class="ml-3">
              <a
                href="/auth/logout"
                class="text-gray-400 hover:text-white transition-colors duration-200"
                title="Logout"
              >
                <i class="fas fa-sign-out-alt"></i>
              </a>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Mobile sidebar backdrop -->
  <div
    class="fixed inset-0 z-40 lg:hidden transition-opacity duration-300 ease-in-out"
    role="dialog"
    style="display: none; opacity: 0;"
    id="mobileSidebarBackdrop"
  >
    <div
      class="fixed inset-0 bg-gray-900 bg-opacity-75 transition-opacity duration-300 ease-in-out"
      aria-hidden="true"
      id="mobileBackdrop"
    ></div>

    <!-- Mobile sidebar -->
    <div
      class="relative flex-1 flex flex-col max-w-xs w-full bg-gray-800 focus:outline-none transition-transform duration-300 ease-in-out transform -translate-x-full"
      id="mobileSidebar"
    >
      <div class="absolute top-0 right-0 -mr-12 pt-2">
        <button
          type="button"
          class="ml-1 flex items-center justify-center h-10 w-10 rounded-full focus:outline-none focus:ring-2 focus:ring-inset focus:ring-white hover:bg-gray-800 transition-colors duration-200"
          onclick="closeMobileSidebar()"
        >
          <span class="sr-only">Close sidebar</span>
          <i class="fas fa-times text-white text-xl"></i>
        </button>
      </div>

      <!-- Logo & Brand -->
      <div class="flex items-center flex-shrink-0 px-4 py-4">
        <div class="flex items-center">
          <div
            class="h-8 w-8 bg-blue-600 rounded-lg flex items-center justify-center"
          >
            <i class="fas fa-shipping-fast text-white text-sm"></i>
          </div>
          <div class="ml-3">
            <h1 class="text-white text-lg font-bold">LogiTrack</h1>
            <p class="text-gray-400 text-xs">Admin Portal</p>
          </div>
        </div>
      </div>

      <!-- Navigation -->
      <nav class="mt-4 flex-1 flex flex-col px-4 space-y-1">
        <!-- Dashboard -->
        <a
          href="/admin"
          class="group flex items-center px-3 py-2.5 text-sm font-medium rounded-lg transition-all duration-200 <%= currentPage === 'dashboard' ? 'bg-blue-600 text-white shadow-lg' : 'text-gray-300 hover:bg-gray-700 hover:text-white' %>"
        >
          <i
            class="fas fa-tachometer-alt mr-3 text-sm w-5 text-center <%= currentPage === 'dashboard' ? 'text-white' : 'text-gray-400 group-hover:text-white' %>"
          ></i>
          Dashboard
        </a>

        <!-- Deliveries -->
        <a
          href="/admin/deliveries"
          class="group flex items-center px-3 py-2.5 text-sm font-medium rounded-lg transition-all duration-200 <%= currentPage === 'deliveries' || currentPage === 'delivery' ? 'bg-blue-600 text-white shadow-lg' : 'text-gray-300 hover:bg-gray-700 hover:text-white' %>"
        >
          <i
            class="fas fa-box mr-3 text-sm w-5 text-center <%= currentPage === 'deliveries' || currentPage === 'delivery' ? 'text-white' : 'text-gray-400 group-hover:text-white' %>"
          ></i>
          Deliveries
          <% if (deliveryCount) { %>
            <span
              class="ml-auto bg-blue-500 text-white text-xs font-medium px-2 py-0.5 rounded-full"
            >
              <%= deliveryCount %>
            </span>
          <% } %>
        </a>

        <!-- Drivers -->
        <a
          href="/admin/drivers"
          class="group flex items-center px-3 py-2.5 text-sm font-medium rounded-lg transition-all duration-200 <%= currentPage === 'drivers' || currentPage === 'driver' ? 'bg-blue-600 text-white shadow-lg' : 'text-gray-300 hover:bg-gray-700 hover:text-white' %>"
        >
          <i
            class="fas fa-users mr-3 text-sm w-5 text-center <%= currentPage === 'drivers' || currentPage === 'driver' ? 'text-white' : 'text-gray-400 group-hover:text-white' %>"
          ></i>
          Drivers
          <% if (driverCount) { %>
            <span
              class="ml-auto bg-green-500 text-white text-xs font-medium px-2 py-0.5 rounded-full"
            >
              <%= driverCount %>
            </span>
          <% } %>
        </a>

        <!-- Warehouses -->
        <a
          href="/admin/warehouses"
          class="group flex items-center px-3 py-2.5 text-sm font-medium rounded-lg transition-all duration-200 <%= currentPage === 'warehouses' || currentPage === 'warehouse' ? 'bg-blue-600 text-white shadow-lg' : 'text-gray-300 hover:bg-gray-700 hover:text-white' %>"
        >
          <i
            class="fas fa-warehouse mr-3 text-sm w-5 text-center <%= currentPage === 'warehouses' || currentPage === 'warehouse' ? 'text-white' : 'text-gray-400 group-hover:text-white' %>"
          ></i>
          Warehouses
        </a>

        <!-- Settings -->
        <a
          href="/admin/settings"
          class="group flex items-center px-3 py-2.5 text-sm font-medium rounded-lg transition-all duration-200 <%= currentPage === 'settings' ? 'bg-blue-600 text-white shadow-lg' : 'text-gray-300 hover:bg-gray-700 hover:text-white' %>"
        >
          <i
            class="fas fa-cog mr-3 text-sm w-5 text-center <%= currentPage === 'settings' ? 'text-white' : 'text-gray-400 group-hover:text-white' %>"
          ></i>
          Settings
        </a>
      </nav>

      <!-- User Profile -->
      <div class="flex-shrink-0 flex border-t border-gray-700 p-4">
        <div class="flex items-center w-full">
          <div class="flex-shrink-0">
            <div class="h-10 w-10 rounded-full bg-blue-500 flex items-center justify-center">
              <span class="text-white font-semibold">
                <%= admin && admin.name ? admin.name.charAt(0).toUpperCase() : 'A' %>
              </span>
            </div>
          </div>
          <div class="ml-3 flex-1">
            <p class="text-sm font-medium text-white">
              <%= admin && admin.name ? admin.name : 'Admin User' %>
            </p>
            <p
              class="text-xs font-medium text-gray-400 group-hover:text-gray-300"
            >
              <%= admin && admin.role ? admin.role : 'Administrator' %>
            </p>
          </div>
          <div class="ml-3">
            <a
              href="/auth/logout"
              class="text-gray-400 hover:text-white transition-colors duration-200"
              title="Logout"
            >
              <i class="fas fa-sign-out-alt"></i>
            </a>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Main Content -->
  <div class="flex flex-col min-w-0 flex-1 overflow-hidden">
    <!-- Mobile top header -->
    <div class="lg:hidden">
      <div
        class="flex items-center justify-between bg-white border-b border-gray-200 px-4 py-3 shadow-sm"
      >
        <div class="flex items-center">
          <button
            type="button"
            class="p-2 rounded-lg text-gray-600 hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-blue-500 transition-colors duration-200"
            onclick="openMobileSidebar()"
          >
            <span class="sr-only">Open sidebar</span>
            <i class="fas fa-bars text-lg"></i>
          </button>
          <div class="ml-3 flex items-center">
            <div
              class="h-8 w-8 bg-blue-600 rounded-lg flex items-center justify-center"
            >
              <i class="fas fa-shipping-fast text-white text-sm"></i>
            </div>
            <h1 class="ml-2 text-lg font-semibold text-gray-900">LogiTrack</h1>
          </div>
        </div>
        <div class="flex items-center space-x-4">
          <a href="/auth/logout" class="text-gray-600 hover:text-gray-900 p-2 rounded-lg hover:bg-gray-100 transition-colors duration-200">
            <i class="fas fa-sign-out-alt"></i>
          </a>
        </div>
      </div>
    </div>

    <!-- Main content area -->
    <div class="flex-1 flex" id="main">
      <main class="flex-1 overflow-y-auto focus:outline-none" id="mainDiv">
        <!-- Your page content will be inserted here -->
        <%- body %>
      </main>
    </div>
  </div>
</div>

<script>
  // Mobile sidebar state
  let isSidebarOpen = false;

  // Open mobile sidebar with smooth transition
  function openMobileSidebar() {
    const backdrop = document.getElementById('mobileSidebarBackdrop');
    const sidebar = document.getElementById('mobileSidebar');
    
    backdrop.style.display = 'block';
    
    // Trigger reflow
    backdrop.offsetHeight;
    
    // Animate backdrop
    backdrop.style.opacity = '1';
    backdrop.style.transition = 'opacity 300ms ease-in-out';
    
    // Animate sidebar
    sidebar.style.transform = 'translateX(0)';
    sidebar.style.transition = 'transform 300ms ease-in-out';
    
    // Prevent body scroll
    document.body.style.overflow = 'hidden';
    
    isSidebarOpen = true;
  }

  // Close mobile sidebar with smooth transition
  function closeMobileSidebar() {
    const backdrop = document.getElementById('mobileSidebarBackdrop');
    const sidebar = document.getElementById('mobileSidebar');
    
    // Animate backdrop
    backdrop.style.opacity = '0';
    
    // Animate sidebar
    sidebar.style.transform = 'translateX(-100%)';
    
    // Hide backdrop after animation
    setTimeout(() => {
      if (!isSidebarOpen) {
        backdrop.style.display = 'none';
      }
    }, 300);
    
    // Restore body scroll
    document.body.style.overflow = '';
    
    isSidebarOpen = false;
  }

  // Close mobile sidebar when clicking on backdrop
  document.getElementById('mobileSidebarBackdrop').addEventListener('click', function (e) {
    if (e.target === this) {
      closeMobileSidebar();
    }
  });

  // Close mobile sidebar when clicking on nav links
  document.querySelectorAll('#mobileSidebar a').forEach((link) => {
    link.addEventListener('click', function() {
      setTimeout(closeMobileSidebar, 100);
    });
  });

  // Close sidebar with Escape key
  document.addEventListener('keydown', function(e) {
    if (e.key === 'Escape' && isSidebarOpen) {
      closeMobileSidebar();
    }
  });

  // Auto-close mobile sidebar on window resize if it becomes large
  window.addEventListener('resize', function() {
    if (window.innerWidth >= 1024 && isSidebarOpen) {
      closeMobileSidebar();
    }
  });

  // Fix for Bootstrap modals: Append to body on load
  document.addEventListener('DOMContentLoaded', function () {
    const modals = document.querySelectorAll('.modal');
    modals.forEach((modal) => {
      if (!document.body.contains(modal)) {
        document.body.appendChild(modal);
      }
    });
    
    // Initialize any tooltips
    const tooltips = [].slice.call(document.querySelectorAll('[data-bs-toggle="tooltip"]'));
    tooltips.forEach((tooltip) => {
      new bootstrap.Tooltip(tooltip);
    });
  });
</script>

<style>
#main {
  height: 100vh;        /* or a fixed height like 600px */
  overflow-y: auto;     /* vertical scrolling */
  overflow-x: hidden;   /* prevent horizontal scroll */
}



  /* Custom scrollbar for sidebar */
  .overflow-y-auto::-webkit-scrollbar {
    width: 6px;
  }

  .overflow-y-auto::-webkit-scrollbar-track {
    background: #374151;
  }

  .overflow-y-auto::-webkit-scrollbar-thumb {
    background: #6b7280;
    border-radius: 3px;
  }

  .overflow-y-auto::-webkit-scrollbar-thumb:hover {
    background: #9ca3af;
  }

  /* Active state glow effect */
  .bg-blue-600 {
    box-shadow: 0 4px 6px -1px rgba(59, 130, 246, 0.3);
  }

  /* Hover effects */
  .hover\:bg-gray-700:hover {
    transform: translateX(2px);
  }

  /* Main content scrollbar */
  main::-webkit-scrollbar {
    width: 8px;
  }

  main::-webkit-scrollbar-track {
    background: #f1f1f1;
  }

  main::-webkit-scrollbar-thumb {
    background: #c1c1c1;
    border-radius: 4px;
  }

  main::-webkit-scrollbar-thumb:hover {
    background: #a1a1a1;
  }

  /* Mobile sidebar backdrop */
  #mobileSidebarBackdrop {
    z-index: 50;
  }

  /* Mobile sidebar */
  #mobileSidebar {
    z-index: 51;
    height: 100vh;
  }

  /* Smooth transitions for all interactive elements */
  a, button, .transition-all {
    transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
  }

  /* Hamburger button animation */
  .hamburger-active {
    transform: rotate(90deg);
  }

  /* Prevent horizontal scroll on mobile */
  body {
    overflow-x: hidden;
  }

  /* Improve touch targets on mobile */
  @media (max-width: 768px) {
    button, a {
      min-height: 44px;
      min-width: 44px;
    }
  }
</style>